<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Logtk__TypeInference (logtk.Logtk__TypeInference)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../index.html">logtk</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Logtk__TypeInference</span></h1></header><div class="spec type" id="type-or_error"><a href="#type-or_error" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>'a or_error</code><code><span class="keyword"> = </span>(<span class="type-var">'a</span>, string) CCResult.t</code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-type_"><a href="#type-type_" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>type_</code><code><span class="keyword"> = </span><a href="../Logtk/TypedSTerm/index.html#type-t">Logtk.TypedSTerm.t</a></code><code></code></div><div class="doc"></div></div><div class="spec type" id="type-untyped"><a href="#type-untyped" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>untyped</code><code><span class="keyword"> = </span><a href="../Logtk/STerm/index.html#type-t">Logtk.STerm.t</a></code><code></code></div><div class="doc"><p>untyped term</p></div></div><div class="spec type" id="type-typed"><a href="#type-typed" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>typed</code><code><span class="keyword"> = </span><a href="../Logtk/TypedSTerm/index.html#type-t">Logtk.TypedSTerm.t</a></code><code></code></div><div class="doc"><p>untyped term</p><p>typed term</p></div></div><div class="spec type" id="type-loc"><a href="#type-loc" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>loc</code><code><span class="keyword"> = </span><a href="../Logtk/ParseLocation/index.html#type-t">Logtk.ParseLocation.t</a></code><code></code></div><div class="doc"><p>typed term</p></div></div><div class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><div class="def exception"><code><span class="keyword">exception </span></code><code><span class="exception">Error</span><span class="keyword"> of </span>string</code></div><div class="doc"></div></div><div class="spec val" id="val-section"><a href="#val-section" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>section : <a href="../Logtk/Util/Section/index.html#type-t">Logtk.Util.Section.t</a></code></div><div class="doc"></div></div><h3>Types for Builtins</h3><div class="spec module" id="module-TyBuiltin"><a href="#module-TyBuiltin" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="TyBuiltin/index.html">TyBuiltin</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><h3>Typing context</h3><p>This module provides a typing context, with an applicative interface.
The context is used to map terms to types locally during type
inference. It also keeps and updates a signature when symbols' types
are inferred.</p><p>This module is quite low-level, and shouldn't be used in simple cases
(see the following modules)</p><div class="spec module" id="module-Ctx"><a href="#module-Ctx" class="anchor"></a><div class="def module"><code><span class="keyword">module </span><a href="Ctx/index.html">Ctx</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><div class="doc"></div></div><div class="spec val" id="val-unify"><a href="#val-unify" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>unify : ?&#8288;loc:<a href="index.html#type-loc">loc</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"></div></div><h3>Hindley-Milner Type Inference</h3><p>This module, abstract in the exact kind of term it types, takes as input
a signature and an <b>untyped term</b>, and updates the typing context
so that the <b>untyped term</b> can be converted into a <b>typed term</b>.</p><div class="spec val" id="val-infer_ty_exn"><a href="#val-infer_ty_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_ty_exn : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a></code></div><div class="doc"><p>Type conversion from <a href="index.html#type-untyped">untyped</a>.</p></div></div><div class="spec val" id="val-infer_ty"><a href="#val-infer_ty" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_ty : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a> <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"><p>Type conversion from <a href="index.html#type-untyped">untyped</a>.</p></div></div><div class="spec val" id="val-infer_exn"><a href="#val-infer_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_exn : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed">typed</a></code></div><div class="doc"><p>Infer the type of this term under the given signature. This updates
the context's typing environment!</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">ctx</span>: the context</li><li><span class="at-tag parameter">Parameter</span> <span class="module-path">untyped</span>: the untyped term whose type must be inferred</li><li><span class="at-tag raise">Raises</span> <span class="module-path">Error</span>: if the types are inconsistent</li></ul></div></div><div class="spec val" id="val-infer"><a href="#val-infer" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed">typed</a> <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"><p>Safe version of <a href="index.html#val-infer_exn">infer_exn</a>. It returns <code class="code">`Error s</code> rather
than raising <a href="index.html#exception-Error">Error</a> if the typechecking fails.</p></div></div><div class="spec val" id="val-infer_prop_exn"><a href="#val-infer_prop_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_prop_exn : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed">typed</a></code></div><div class="doc"><p>Same as <a href="index.html#val-infer_exn">infer_exn</a> but forces the type of its result
to be <span class="xref-unresolved" title="unresolved reference to &quot;TypedSTerm.prop&quot;">TypedSTerm.prop</span></p></div></div><div class="spec val" id="val-infer_clause_exn"><a href="#val-infer_clause_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_clause_exn : <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> list <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed">typed</a> list</code></div><div class="doc"><p>Convert a clause. Free variables in each of the list's elements
are shared</p></div></div><h4>Constraining types</h4><p>This section is mostly useful for inferring a signature without
converting untyped_terms into typed_terms.</p><div class="spec val" id="val-constrain_term_term_exn"><a href="#val-constrain_term_term_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>constrain_term_term_exn : ?&#8288;loc:<a href="index.html#type-loc">loc</a> <span class="keyword">&#8209;&gt;</span> <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Force the two terms to have the same type in this context</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">Error</span>: if an inconsistency is detected</li></ul></div></div><div class="spec val" id="val-constrain_term_type_exn"><a href="#val-constrain_term_type_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>constrain_term_type_exn : ?&#8288;loc:<a href="index.html#type-loc">loc</a> <span class="keyword">&#8209;&gt;</span> <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a> <span class="keyword">&#8209;&gt;</span> unit</code></div><div class="doc"><p>Force the term's type and the given type to be the same.</p><ul class="at-tag"><li><span class="at-tag raise">Raises</span> <span class="module-path">Error</span>: if an inconsistency is detected</li></ul></div></div><div class="spec val" id="val-constrain_term_term"><a href="#val-constrain_term_term" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>constrain_term_term : ?&#8288;loc:<a href="index.html#type-loc">loc</a> <span class="keyword">&#8209;&gt;</span> <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"><p>Safe version of <a href="index.html#val-constrain_term_term_exn">constrain_term_term_exn</a></p></div></div><div class="spec val" id="val-constrain_term_type"><a href="#val-constrain_term_type" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>constrain_term_type : ?&#8288;loc:<a href="index.html#type-loc">loc</a> <span class="keyword">&#8209;&gt;</span> <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-untyped">untyped</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-type_">type_</a> <span class="keyword">&#8209;&gt;</span> unit <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"><p>Safe version of <a href="index.html#val-constrain_term_type_exn">constrain_term_type_exn</a></p></div></div><h3>Statements</h3><div class="spec type" id="type-typed_statement"><a href="#type-typed_statement" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>typed_statement</code><code><span class="keyword"> = </span>(<a href="index.html#type-typed">typed</a>, <a href="index.html#type-typed">typed</a>, <a href="index.html#type-type_">type_</a>) <a href="../Logtk/Statement/index.html#type-t">Logtk.Statement.t</a></code><code></code></div><div class="doc"></div></div><div class="spec val" id="val-infer_statement_exn"><a href="#val-infer_statement_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_statement_exn : ?&#8288;file:string <span class="keyword">&#8209;&gt;</span> <a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Logtk/UntypedAST/index.html#type-statement">Logtk.UntypedAST.statement</a> <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed_statement">typed_statement</a><span class="keyword"> * </span><a href="index.html#type-typed_statement">typed_statement</a> list</code></div><div class="doc"><p><code class="code">infer_statement ctx ~f st</code> checks and convert <code class="code">st</code> into a
typed statements, and a list of auxiliary type declarations for symbols
that were inferred implicitely.</p></div></div><div class="spec val" id="val-infer_statements_exn"><a href="#val-infer_statements_exn" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_statements_exn : ?&#8288;def_as_rewrite:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;on_var:[ `Infer | `Default ] <span class="keyword">&#8209;&gt;</span> ?&#8288;on_undef:[ `Warn | `Fail | `Guess ] <span class="keyword">&#8209;&gt;</span> ?&#8288;on_shadow:[ `Warn | `Ignore ] <span class="keyword">&#8209;&gt;</span> ?&#8288;ctx:<a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;file:string <span class="keyword">&#8209;&gt;</span> implicit_ty_args:bool <span class="keyword">&#8209;&gt;</span> <a href="../Logtk/UntypedAST/index.html#type-statement">Logtk.UntypedAST.statement</a> Sequence.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed_statement">typed_statement</a> CCVector.ro_vector</code></div><div class="doc"><p>Infer all statements</p><ul class="at-tag"><li><span class="at-tag parameter">Parameter</span> <span class="module-path">def_as_rewrite</span>: if true, definitions becomes rewrite rules</li></ul></div></div><div class="spec val" id="val-infer_statements"><a href="#val-infer_statements" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>infer_statements : ?&#8288;def_as_rewrite:bool <span class="keyword">&#8209;&gt;</span> ?&#8288;on_var:[ `Infer | `Default ] <span class="keyword">&#8209;&gt;</span> ?&#8288;on_undef:[ `Warn | `Fail | `Guess ] <span class="keyword">&#8209;&gt;</span> ?&#8288;on_shadow:[ `Warn | `Ignore ] <span class="keyword">&#8209;&gt;</span> ?&#8288;ctx:<a href="Ctx/index.html#type-t">Ctx.t</a> <span class="keyword">&#8209;&gt;</span> ?&#8288;file:string <span class="keyword">&#8209;&gt;</span> implicit_ty_args:bool <span class="keyword">&#8209;&gt;</span> <a href="../Logtk/UntypedAST/index.html#type-statement">Logtk.UntypedAST.statement</a> Sequence.t <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-typed_statement">typed_statement</a> CCVector.ro_vector <a href="index.html#type-or_error">or_error</a></code></div><div class="doc"></div></div></body></html>